{% extends 'base.html' %}
{% block content %}
{% load static %}

</style>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>
<div class="body-wrapper">
    <div class="container-fluid">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                {% if log_id.user_type == 'Staff' %} <li class="breadcrumb-item"><a href="{% url 'staff_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>{% endif %}
                {% if log_id.user_type == 'Company' %} <li class="breadcrumb-item"><a href="{% url 'company_dashboard' %}" class="text-warning-emphasis">Dashboard</a></li>{% endif %}
                 <li class="breadcrumb-item"><a href="#" class="text-warning-emphasis">Payroll_list</a></li>
                 <li class="breadcrumb-item" aria-current="page">CREATE employee</li>
        </nav>
        <div class="row mt-5">
            <div class="col-md-12">
                <div class="card mb-3 bg-black shadow p-3 mb-5 rounded" style="max-width: 1200px;">
                  <div class="row mt-4">
        <section>
            <div class="container pl-5" style="color:white;">
                <div class="header pb-5">
                    <h2 style="text-align: center;color:white;">EDIT ADDITIONAL LOAN</h2>
                    <hr class="text-warning font-weight-bold">
                    {% for message in messages %}
                    <h5>
                        <div class="alert alert-danger message">
                            {{ message }}
                        </div>
                    </h5>
                    {% endfor %}
                </div>
                <form action="{% url 'edit_additional_loan' repayment.id %}" method="post" class="needs-validation" novalidate autocomplete="off">
                    {%csrf_token%}
                    <div class="row">
                      <div class="col-md-6">
                        <label for="origin" style="color: white;">Balance Loan</label>
                        <input type="text" class="form-control text-white bg-black mt-1" id="balance" name="balance" value="{{ overall_balance }}" readonly>
                      </div>
                      <div class="col-md-6">
                        <label for="origin" style="color: white;">New Loan</label>
                        <input type="number" class="form-control text-white bg-black mt-1" id="principalamount" name="principal_amount" value="{{repayment.principal_amount}}">
                      </div>
                      
                    </div>

                    <div class="row mt-3">
                      <div class="col-md-6">
                        <label for="origin" style="color: white;">Interest Amount</label>
                        <input type="number" class="form-control text-white bg-black mt-1" id="interestamount" name="interest_amount" value="{{repayment.interest_amount }}">
                      </div>
                      
                      <div class="col-md-6">
                        <label for="date" style="color: white;">Date</label>
                        <input type="date" class="form-control text-white bg-black mt-1" id="date"  name="date" value="{{repayment.payment_date | date:'Y-m-d'}}">
                      </div>
                    </div>

                    <div class="row mt-3">
                      <div class="col-md-6">
                        <label for="amount" style="color: white;">Total Loan</label>
                        <input type="number" class="form-control text-white bg-black mt-1" id="totalamount"  name="total_amount" value="{{repayment.total_amount}}">
                      </div>
                      <div class="col-md-6">
                        <label for="dest" style="color: white;">Payment Method</label>
                        <select class="form-control text-white bg-black form-select mt-1" id="paymentmethod" name="payment_method">
                          <option value="Cash" {% if repayment.payment_method == 'Cash' %} selected {% endif %}>Cash</option>
                          <option value="UPI" {% if repayment.payment_method == 'UPI' %} selected {% endif %}>UPI</option>
                          <option value="Cheque" {% if repayment.payment_method == 'Cheque' %} selected {% endif %}>Cheque</option>
                          
                        </select>
                      </div>
                    </div>
                    <div class="row mt-3" id="chequedetails" style="display: none;">
                      <div class="col-md-6">
                          <label for="cheque_number" style="color: white;">Cheque Number</label>
                          <input type="text" class="form-control text-white bg-black mt-1" id="cheque_number" name="cheque_number" value="{{repayment.cheque}}">
                      </div>
                  </div>

                  <!-- Text box for UPI -->
                  <div class="row mt-3" id="upidetails" style="display: none;">
                      <div class="col-md-6">
                          <label for="upi_id" style="color: white;">UPI ID</label>
                          <input type="text" class="form-control text-white bg-black mt-1" id="upi_id" name="upi_id" value="{{repayment.upi_id}}">
                      </div>
                  </div>

                   

                    <div class="row mt-3">
                      <div class="col-md-4"></div>
                      <div class="col-md-4">
                        <div class="d-flex">
                          <button class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="submit" data-dismiss="modal" id="paySave" style="color: #ffae1f;">Save</button> 
                          <input class="btn save_btn btn-outline-warning mt-2 my-4 mx-2 w-50" type="reset" value="Reset" style="color: #ffae1f;">
                        </div>
                      </div>
                      <div class="col-md-4"></div>
                    </div>
                  </form>
                            <!-- <button type="submit"  class="btn btn-outline-warning custom-btn" > Save</button>
                        </div>
                    </div> -->
        
                        </section>
                        <script>
                          document.addEventListener('DOMContentLoaded', function() {
                              var principalInput = document.getElementById('principalamount');
                              var interestInput = document.getElementById('interestamount');
                              var totalAmountInput = document.getElementById('totalamount');
                        
                              function calculateTotal() {
                                  var principal = parseFloat(principalInput.value) || 0;
                                  var interest = parseFloat(interestInput.value) || 0;
                                  var total = principal + interest;
                                  totalAmountInput.value = total.toFixed();
                              }
                        
                              principalInput.addEventListener('input', calculateTotal);
                              interestInput.addEventListener('input', calculateTotal);
                              calculateTotal(); 
                          });
                        </script>
                     
                        <script>
                          $(document).ready(function() {
                              $('#paymentmethod').change(function() {
                                  var selectedOption = $(this).val();
                                  if (selectedOption === 'Cheque') {
                                      $('#chequedetails').show();
                                      $('#upidetails').hide();
                                  } else if (selectedOption === 'UPI') {
                                      $('#chequedetails').hide();
                                      $('#upidetails').show();
                                  } else {
                                      $('#chequedetails').hide();
                                      $('#upidetails').hide();
                                  }
                              });
                              var selectedOption = $('#paymentmethod').val();
                              if (selectedOption === 'Cheque') {
                              $('#chequedetails').show();
                              } else if (selectedOption === 'UPI') {
                              $('#upidetails').show();
                              }
                              });
                        
                        </script>

                        
                        

{% endblock %}
